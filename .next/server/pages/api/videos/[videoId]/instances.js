"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/videos/[videoId]/instances";
exports.ids = ["pages/api/videos/[videoId]/instances"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "./pages/api/videos/[videoId]/instances/index.ts":
/*!*******************************************************!*\
  !*** ./pages/api/videos/[videoId]/instances/index.ts ***!
  \*******************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__) => {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var _services__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../services */ \"./services/index.ts\");\n/* harmony import */ var _services_videoService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../services/videoService */ \"./services/videoService.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([uuid__WEBPACK_IMPORTED_MODULE_0__]);\nuuid__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? await __webpack_async_dependencies__ : __webpack_async_dependencies__)[0];\n// Next.js API route support: https://nextjs.org/docs/api-routes/introduction\n\n\n\nasync function handler(req, res) {\n  if (req.method === 'POST') {\n    const videoId = req.query.videoId;\n    const paymentUsername = req.body.payment_username;\n\n    if (!videoId && !paymentUsername) {\n      res.status(400);\n      res.json({\n        error: 'Missing fields'\n      });\n      return;\n    }\n\n    const {\n      data,\n      error\n    } = await _services__WEBPACK_IMPORTED_MODULE_1__.supabaseServer.from('videos').select().eq('id', videoId);\n\n    if (error) {\n      throw error;\n    }\n\n    const video = data[0];\n    const videoLength = video.length;\n    const questionTimestamps = (0,_services_videoService__WEBPACK_IMPORTED_MODULE_2__.calculateQuestionTimestamps)(videoLength);\n    const questions = questionTimestamps.map(timestamp => {\n      return {\n        timestamp,\n        id: (0,uuid__WEBPACK_IMPORTED_MODULE_0__.v4)(),\n        code: (0,_services_videoService__WEBPACK_IMPORTED_MODULE_2__.generateQuestionCode)(6)\n      };\n    });\n    const newInstancePayload = {\n      video_id: videoId,\n      payment_username: paymentUsername,\n      questions\n    };\n    const {\n      data: newInstanceData,\n      error: newErrorData\n    } = await _services__WEBPACK_IMPORTED_MODULE_1__.supabaseServer.from('video_instances').insert([newInstancePayload]);\n\n    if (newErrorData) {\n      res.status(400);\n      res.json({\n        error\n      });\n      return;\n    }\n\n    res.status(201);\n    res.json({\n      data: {\n        code: newInstanceData[0].code\n      }\n    });\n  }\n}\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy9hcGkvdmlkZW9zL1t2aWRlb0lkXS9pbnN0YW5jZXMvaW5kZXgudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRWUsZUFBZUssT0FBZixDQUNYQyxHQURXLEVBRVhDLEdBRlcsRUFHYjtBQUNFLE1BQUlELEdBQUcsQ0FBQ0UsTUFBSixLQUFlLE1BQW5CLEVBQTJCO0FBQ3ZCLFVBQU1DLE9BQU8sR0FBR0gsR0FBRyxDQUFDSSxLQUFKLENBQVVELE9BQTFCO0FBQ0EsVUFBTUUsZUFBZSxHQUFHTCxHQUFHLENBQUNNLElBQUosQ0FBU0MsZ0JBQWpDOztBQUVBLFFBQUksQ0FBQ0osT0FBRCxJQUFZLENBQUNFLGVBQWpCLEVBQWtDO0FBQzlCSixNQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ1EsSUFBSixDQUFTO0FBQUNDLFFBQUFBLEtBQUssRUFBRTtBQUFSLE9BQVQ7QUFDQTtBQUNIOztBQUVELFVBQU07QUFBQ0MsTUFBQUEsSUFBRDtBQUFPRCxNQUFBQTtBQUFQLFFBQWdCLE1BQU1kLDBEQUFBLENBQ2xCLFFBRGtCLEVBRXZCaUIsTUFGdUIsR0FHdkJDLEVBSHVCLENBR3BCLElBSG9CLEVBR2RYLE9BSGMsQ0FBNUI7O0FBS0EsUUFBSU8sS0FBSixFQUFXO0FBQ1AsWUFBTUEsS0FBTjtBQUNIOztBQUVELFVBQU1LLEtBQUssR0FBR0osSUFBSSxDQUFDLENBQUQsQ0FBbEI7QUFDQSxVQUFNSyxXQUFXLEdBQUdELEtBQUssQ0FBQ0UsTUFBMUI7QUFDQSxVQUFNQyxrQkFBa0IsR0FBR3JCLG1GQUEyQixDQUFDbUIsV0FBRCxDQUF0RDtBQUNBLFVBQU1HLFNBQVMsR0FBR0Qsa0JBQWtCLENBQUNFLEdBQW5CLENBQXVCQyxTQUFTLElBQUk7QUFDbEQsYUFBTztBQUNIQSxRQUFBQSxTQURHO0FBRUhDLFFBQUFBLEVBQUUsRUFBRTNCLHdDQUFJLEVBRkw7QUFHSDRCLFFBQUFBLElBQUksRUFBRXpCLDRFQUFvQixDQUFDLENBQUQ7QUFIdkIsT0FBUDtBQUtILEtBTmlCLENBQWxCO0FBUUEsVUFBTTBCLGtCQUFrQixHQUFHO0FBQ3ZCQyxNQUFBQSxRQUFRLEVBQUV0QixPQURhO0FBRXZCSSxNQUFBQSxnQkFBZ0IsRUFBRUYsZUFGSztBQUd2QmMsTUFBQUE7QUFIdUIsS0FBM0I7QUFNQSxVQUFNO0FBQUNSLE1BQUFBLElBQUksRUFBRWUsZUFBUDtBQUF3QmhCLE1BQUFBLEtBQUssRUFBRWlCO0FBQS9CLFFBQStDLE1BQU0vQiwwREFBQSxDQUNqRCxpQkFEaUQsRUFFdERnQyxNQUZzRCxDQUUvQyxDQUFDSixrQkFBRCxDQUYrQyxDQUEzRDs7QUFJQSxRQUFJRyxZQUFKLEVBQWtCO0FBQ2QxQixNQUFBQSxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ1EsSUFBSixDQUFTO0FBQUNDLFFBQUFBO0FBQUQsT0FBVDtBQUNBO0FBQ0g7O0FBRURULElBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXLEdBQVg7QUFDQVAsSUFBQUEsR0FBRyxDQUFDUSxJQUFKLENBQVM7QUFBQ0UsTUFBQUEsSUFBSSxFQUFFO0FBQ1pZLFFBQUFBLElBQUksRUFBRUcsZUFBZSxDQUFDLENBQUQsQ0FBZixDQUFtQkg7QUFEYjtBQUFQLEtBQVQ7QUFHSDtBQUNKLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbmltYWxhZ3JpY3VsdHVyZS8uL3BhZ2VzL2FwaS92aWRlb3MvW3ZpZGVvSWRdL2luc3RhbmNlcy9pbmRleC50cz80ODgyIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIE5leHQuanMgQVBJIHJvdXRlIHN1cHBvcnQ6IGh0dHBzOi8vbmV4dGpzLm9yZy9kb2NzL2FwaS1yb3V0ZXMvaW50cm9kdWN0aW9uXG5pbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQge3Y0IGFzIHV1aWR9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IHsgc3VwYWJhc2VTZXJ2ZXIgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9zZXJ2aWNlcyc7XG5pbXBvcnQgeyBjYWxjdWxhdGVRdWVzdGlvblRpbWVzdGFtcHMsIGdlbmVyYXRlUXVlc3Rpb25Db2RlIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc2VydmljZXMvdmlkZW9TZXJ2aWNlJztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihcbiAgICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICAgIHJlczogTmV4dEFwaVJlc3BvbnNlXG4pIHtcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgIGNvbnN0IHZpZGVvSWQgPSByZXEucXVlcnkudmlkZW9JZDtcbiAgICAgICAgY29uc3QgcGF5bWVudFVzZXJuYW1lID0gcmVxLmJvZHkucGF5bWVudF91c2VybmFtZTtcblxuICAgICAgICBpZiAoIXZpZGVvSWQgJiYgIXBheW1lbnRVc2VybmFtZSkge1xuICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDApO1xuICAgICAgICAgICAgcmVzLmpzb24oe2Vycm9yOiAnTWlzc2luZyBmaWVsZHMnfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7ZGF0YSwgZXJyb3J9ID0gYXdhaXQgc3VwYWJhc2VTZXJ2ZXJcbiAgICAgICAgICAgIC5mcm9tKCd2aWRlb3MnKVxuICAgICAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgICAgICAuZXEoJ2lkJywgdmlkZW9JZCk7XG5cbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZpZGVvID0gZGF0YVswXTtcbiAgICAgICAgY29uc3QgdmlkZW9MZW5ndGggPSB2aWRlby5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHF1ZXN0aW9uVGltZXN0YW1wcyA9IGNhbGN1bGF0ZVF1ZXN0aW9uVGltZXN0YW1wcyh2aWRlb0xlbmd0aCk7XG4gICAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IHF1ZXN0aW9uVGltZXN0YW1wcy5tYXAodGltZXN0YW1wID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICAgICAgICAgIGlkOiB1dWlkKCksXG4gICAgICAgICAgICAgICAgY29kZTogZ2VuZXJhdGVRdWVzdGlvbkNvZGUoNilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgbmV3SW5zdGFuY2VQYXlsb2FkID0ge1xuICAgICAgICAgICAgdmlkZW9faWQ6IHZpZGVvSWQsXG4gICAgICAgICAgICBwYXltZW50X3VzZXJuYW1lOiBwYXltZW50VXNlcm5hbWUsXG4gICAgICAgICAgICBxdWVzdGlvbnMsXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7ZGF0YTogbmV3SW5zdGFuY2VEYXRhLCBlcnJvcjogbmV3RXJyb3JEYXRhfSA9IGF3YWl0IHN1cGFiYXNlU2VydmVyXG4gICAgICAgICAgICAuZnJvbSgndmlkZW9faW5zdGFuY2VzJylcbiAgICAgICAgICAgIC5pbnNlcnQoW25ld0luc3RhbmNlUGF5bG9hZF0pO1xuXG4gICAgICAgIGlmIChuZXdFcnJvckRhdGEpIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAwKTtcbiAgICAgICAgICAgIHJlcy5qc29uKHtlcnJvcn0pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzLnN0YXR1cygyMDEpO1xuICAgICAgICByZXMuanNvbih7ZGF0YToge1xuICAgICAgICAgICAgY29kZTogbmV3SW5zdGFuY2VEYXRhWzBdLmNvZGVcbiAgICAgICAgfX0pO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJ2NCIsInV1aWQiLCJzdXBhYmFzZVNlcnZlciIsImNhbGN1bGF0ZVF1ZXN0aW9uVGltZXN0YW1wcyIsImdlbmVyYXRlUXVlc3Rpb25Db2RlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInZpZGVvSWQiLCJxdWVyeSIsInBheW1lbnRVc2VybmFtZSIsImJvZHkiLCJwYXltZW50X3VzZXJuYW1lIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZGF0YSIsImZyb20iLCJzZWxlY3QiLCJlcSIsInZpZGVvIiwidmlkZW9MZW5ndGgiLCJsZW5ndGgiLCJxdWVzdGlvblRpbWVzdGFtcHMiLCJxdWVzdGlvbnMiLCJtYXAiLCJ0aW1lc3RhbXAiLCJpZCIsImNvZGUiLCJuZXdJbnN0YW5jZVBheWxvYWQiLCJ2aWRlb19pZCIsIm5ld0luc3RhbmNlRGF0YSIsIm5ld0Vycm9yRGF0YSIsImluc2VydCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./pages/api/videos/[videoId]/instances/index.ts\n");

/***/ }),

/***/ "./services/index.ts":
/*!***************************!*\
  !*** ./services/index.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"supabase\": () => (/* binding */ supabase),\n/* harmony export */   \"supabaseServer\": () => (/* binding */ supabaseServer)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n // Create a single supabase client for interacting with your database\n\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)('https://lgorurlbqociyuaxqpon.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYzNzgzNjEyOCwiZXhwIjoxOTUzNDEyMTI4fQ.REMBIXKmWgwy-uZ2EVd2YREawtFe9pl1t6JoU7730Jc');\nconst supabaseServer = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)('https://lgorurlbqociyuaxqpon.supabase.co', process.env.SUPABASE_SECRET);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zZXJ2aWNlcy9pbmRleC50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0NBRUE7O0FBQ08sTUFBTUMsUUFBUSxHQUFHRCxtRUFBWSxDQUFDLDBDQUFELEVBQTZDLHFKQUE3QyxDQUE3QjtBQUNBLE1BQU1FLGNBQWMsR0FBR0YsbUVBQVksQ0FBQywwQ0FBRCxFQUE2Q0csT0FBTyxDQUFDQyxHQUFSLENBQVlDLGVBQXpELENBQW5DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYW5pbWFsYWdyaWN1bHR1cmUvLi9zZXJ2aWNlcy9pbmRleC50cz85ZWMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcblxuLy8gQ3JlYXRlIGEgc2luZ2xlIHN1cGFiYXNlIGNsaWVudCBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB5b3VyIGRhdGFiYXNlXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoJ2h0dHBzOi8vbGdvcnVybGJxb2NpeXVheHFwb24uc3VwYWJhc2UuY28nLCAnZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnliMnhsSWpvaVlXNXZiaUlzSW1saGRDSTZNVFl6Tnpnek5qRXlPQ3dpWlhod0lqb3hPVFV6TkRFeU1USTRmUS5SRU1CSVhLbVdnd3ktdVoyRVZkMllSRWF3dEZlOXBsMXQ2Sm9VNzczMEpjJylcbmV4cG9ydCBjb25zdCBzdXBhYmFzZVNlcnZlciA9IGNyZWF0ZUNsaWVudCgnaHR0cHM6Ly9sZ29ydXJsYnFvY2l5dWF4cXBvbi5zdXBhYmFzZS5jbycsIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFQ1JFVCk7Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlIiwic3VwYWJhc2VTZXJ2ZXIiLCJwcm9jZXNzIiwiZW52IiwiU1VQQUJBU0VfU0VDUkVUIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./services/index.ts\n");

/***/ }),

/***/ "./services/videoService.ts":
/*!**********************************!*\
  !*** ./services/videoService.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"calculateQuestionTimestamps\": () => (/* binding */ calculateQuestionTimestamps),\n/* harmony export */   \"generateQuestionCode\": () => (/* binding */ generateQuestionCode),\n/* harmony export */   \"createVideoInstance\": () => (/* binding */ createVideoInstance),\n/* harmony export */   \"getVideoInstance\": () => (/* binding */ getVideoInstance)\n/* harmony export */ });\n/**\n * \n * @param seconds The duration of the video\n * @returns An array of timestamps corresponding to when we should ask the user questions.\n * \n * Calculates timestamps for when we should ask a user a question, based on the length of\n * the video.\n */\nconst calculateQuestionTimestamps = seconds => {\n  const numberOfMinutes = Math.ceil(seconds / 60);\n  let numberOfQuestions;\n\n  if (numberOfMinutes < 5) {\n    numberOfQuestions = 3;\n  } else if (numberOfMinutes < 10) {\n    numberOfQuestions = 5;\n  } else if (numberOfMinutes < 30) {\n    numberOfQuestions = Math.floor(numberOfMinutes / 3);\n  } else {\n    numberOfQuestions = Math.floor(numberOfMinutes / 10);\n  }\n\n  const questionTimestamps = [];\n\n  for (let i = 1; i <= numberOfQuestions; i++) {\n    const gapInSeconds = seconds / numberOfQuestions;\n    let timestampIsInvalid = true;\n\n    while (timestampIsInvalid) {\n      // We can offset each question by up to 10% of the length of the video\n      const secondsOffsetMagnitude = Math.random() * (seconds / 10);\n      const isOffsetNegative = Math.random() <= .5;\n      const secondsOffset = isOffsetNegative ? secondsOffsetMagnitude * -1 : secondsOffsetMagnitude;\n      const timestamp = Math.floor(i * gapInSeconds + secondsOffset); // A timestamp is only valid if it isn't beyond the final 5% of the video's length\n      // and it is not less than 0\n\n      if (timestamp < seconds - seconds / 20 || timestamp < 0) {\n        timestampIsInvalid = false;\n        questionTimestamps.push(timestamp);\n      }\n    }\n  }\n\n  return questionTimestamps;\n};\nconst generateQuestionCode = length => {\n  let result = '';\n  const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  const charactersLength = characters.length;\n\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n\n  return result;\n};\nconst createVideoInstance = async (videoId, paymentUsername) => {\n  return await fetch(`/api/videos/${videoId}/instances`, {\n    method: 'POST',\n    body: JSON.stringify({\n      payment_username: paymentUsername\n    }),\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }).then(res => res.json());\n};\nconst getVideoInstance = async (videoId, code) => {\n  return await fetch(`/api/videos/${videoId}/instances/${code}`).then(res => res.json());\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ2pCQyxNQUFBQSxnQkFBZ0IsRUFBRU47QUFERCxLQUFmLENBRnlDO0FBSy9DTyxJQUFBQSxPQUFPLEVBQUU7QUFDTCxzQkFBZ0I7QUFEWDtBQUxzQyxHQUFyQyxDQUFMLENBU1JDLElBVFEsQ0FTRkMsR0FBRCxJQUFTQSxHQUFHLENBQUNDLElBQUosRUFUTixDQUFiO0FBVUgsQ0FYTTtBQWFBLE1BQU1DLGdCQUFnQixHQUFHLE9BQU9aLE9BQVAsRUFBd0JhLElBQXhCLEtBQXlDO0FBQ3JFLFNBQU8sTUFBTVgsS0FBSyxDQUFFLGVBQWNGLE9BQVEsY0FBYWEsSUFBSyxFQUExQyxDQUFMLENBQ1JKLElBRFEsQ0FDRkMsR0FBRCxJQUFTQSxHQUFHLENBQUNDLElBQUosRUFETixDQUFiO0FBRUgsQ0FITSIsInNvdXJjZXMiOlsid2VicGFjazovL2FuaW1hbGFncmljdWx0dXJlLy4vc2VydmljZXMvdmlkZW9TZXJ2aWNlLnRzPzNhMDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tIFwiLlwiO1xuXG4vKipcbiAqIFxuICogQHBhcmFtIHNlY29uZHMgVGhlIGR1cmF0aW9uIG9mIHRoZSB2aWRlb1xuICogQHJldHVybnMgQW4gYXJyYXkgb2YgdGltZXN0YW1wcyBjb3JyZXNwb25kaW5nIHRvIHdoZW4gd2Ugc2hvdWxkIGFzayB0aGUgdXNlciBxdWVzdGlvbnMuXG4gKiBcbiAqIENhbGN1bGF0ZXMgdGltZXN0YW1wcyBmb3Igd2hlbiB3ZSBzaG91bGQgYXNrIGEgdXNlciBhIHF1ZXN0aW9uLCBiYXNlZCBvbiB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgdmlkZW8uXG4gKi9cbmV4cG9ydCBjb25zdCBjYWxjdWxhdGVRdWVzdGlvblRpbWVzdGFtcHMgPSAoc2Vjb25kczogbnVtYmVyKTogbnVtYmVyW10gPT4ge1xuICAgIGNvbnN0IG51bWJlck9mTWludXRlcyA9IE1hdGguY2VpbChzZWNvbmRzIC8gNjApO1xuICAgIGxldCBudW1iZXJPZlF1ZXN0aW9ucztcblxuICAgIGlmIChudW1iZXJPZk1pbnV0ZXMgPCA1KSB7XG4gICAgICAgIG51bWJlck9mUXVlc3Rpb25zID0gMztcbiAgICB9IGVsc2UgaWYgKG51bWJlck9mTWludXRlcyA8IDEwKSB7XG4gICAgICAgIG51bWJlck9mUXVlc3Rpb25zID0gNTtcbiAgICB9IGVsc2UgaWYgKG51bWJlck9mTWludXRlcyA8IDMwKSB7XG4gICAgICAgIG51bWJlck9mUXVlc3Rpb25zID0gTWF0aC5mbG9vcihudW1iZXJPZk1pbnV0ZXMgLyAzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBudW1iZXJPZlF1ZXN0aW9ucyA9IE1hdGguZmxvb3IobnVtYmVyT2ZNaW51dGVzIC8gMTApO1xuICAgIH1cblxuICAgIGNvbnN0IHF1ZXN0aW9uVGltZXN0YW1wcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IG51bWJlck9mUXVlc3Rpb25zOyBpKyspIHtcbiAgICAgICAgY29uc3QgZ2FwSW5TZWNvbmRzID0gc2Vjb25kcyAvIG51bWJlck9mUXVlc3Rpb25zO1xuICAgICAgICBsZXQgdGltZXN0YW1wSXNJbnZhbGlkID0gdHJ1ZTtcblxuICAgICAgICB3aGlsZSAodGltZXN0YW1wSXNJbnZhbGlkKSB7XG4gICAgICAgICAgICAvLyBXZSBjYW4gb2Zmc2V0IGVhY2ggcXVlc3Rpb24gYnkgdXAgdG8gMTAlIG9mIHRoZSBsZW5ndGggb2YgdGhlIHZpZGVvXG4gICAgICAgICAgICBjb25zdCBzZWNvbmRzT2Zmc2V0TWFnbml0dWRlID0gTWF0aC5yYW5kb20oKSAqIChzZWNvbmRzIC8gMTApO1xuICAgICAgICAgICAgY29uc3QgaXNPZmZzZXROZWdhdGl2ZSA9IE1hdGgucmFuZG9tKCkgPD0gLjU7XG4gICAgICAgICAgICBjb25zdCBzZWNvbmRzT2Zmc2V0ID0gaXNPZmZzZXROZWdhdGl2ZSA/IHNlY29uZHNPZmZzZXRNYWduaXR1ZGUgKiAtMSA6IHNlY29uZHNPZmZzZXRNYWduaXR1ZGU7XG4gICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBNYXRoLmZsb29yKChpICogZ2FwSW5TZWNvbmRzKSArIHNlY29uZHNPZmZzZXQpO1xuXG4gICAgICAgICAgICAvLyBBIHRpbWVzdGFtcCBpcyBvbmx5IHZhbGlkIGlmIGl0IGlzbid0IGJleW9uZCB0aGUgZmluYWwgNSUgb2YgdGhlIHZpZGVvJ3MgbGVuZ3RoXG4gICAgICAgICAgICAvLyBhbmQgaXQgaXMgbm90IGxlc3MgdGhhbiAwXG4gICAgICAgICAgICBpZiAodGltZXN0YW1wIDwgc2Vjb25kcyAtIChzZWNvbmRzIC8gMjApIHx8IHRpbWVzdGFtcCA8IDApIHtcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXBJc0ludmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBxdWVzdGlvblRpbWVzdGFtcHMucHVzaCh0aW1lc3RhbXApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHF1ZXN0aW9uVGltZXN0YW1wcztcbn1cblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlUXVlc3Rpb25Db2RlID0gKGxlbmd0aDogbnVtYmVyKSA9PiB7XG4gICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgIGNvbnN0IGNoYXJhY3RlcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODknO1xuICAgIGNvbnN0IGNoYXJhY3RlcnNMZW5ndGggPSBjaGFyYWN0ZXJzLmxlbmd0aDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcmVzdWx0ICs9IGNoYXJhY3RlcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJhY3RlcnNMZW5ndGgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlVmlkZW9JbnN0YW5jZSA9IGFzeW5jICh2aWRlb0lkOiBudW1iZXIsIHBheW1lbnRVc2VybmFtZTogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IGZldGNoKGAvYXBpL3ZpZGVvcy8ke3ZpZGVvSWR9L2luc3RhbmNlc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIHBheW1lbnRfdXNlcm5hbWU6IHBheW1lbnRVc2VybmFtZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAudGhlbigocmVzKSA9PiByZXMuanNvbigpKVxufVxuXG5leHBvcnQgY29uc3QgZ2V0VmlkZW9JbnN0YW5jZSA9IGFzeW5jICh2aWRlb0lkOiBudW1iZXIsIGNvZGU6IHN0cmluZykgPT4ge1xuICAgIHJldHVybiBhd2FpdCBmZXRjaChgL2FwaS92aWRlb3MvJHt2aWRlb0lkfS9pbnN0YW5jZXMvJHtjb2RlfWApXG4gICAgICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXG59Il0sIm5hbWVzIjpbImNhbGN1bGF0ZVF1ZXN0aW9uVGltZXN0YW1wcyIsInNlY29uZHMiLCJudW1iZXJPZk1pbnV0ZXMiLCJNYXRoIiwiY2VpbCIsIm51bWJlck9mUXVlc3Rpb25zIiwiZmxvb3IiLCJxdWVzdGlvblRpbWVzdGFtcHMiLCJpIiwiZ2FwSW5TZWNvbmRzIiwidGltZXN0YW1wSXNJbnZhbGlkIiwic2Vjb25kc09mZnNldE1hZ25pdHVkZSIsInJhbmRvbSIsImlzT2Zmc2V0TmVnYXRpdmUiLCJzZWNvbmRzT2Zmc2V0IiwidGltZXN0YW1wIiwicHVzaCIsImdlbmVyYXRlUXVlc3Rpb25Db2RlIiwibGVuZ3RoIiwicmVzdWx0IiwiY2hhcmFjdGVycyIsImNoYXJhY3RlcnNMZW5ndGgiLCJjaGFyQXQiLCJjcmVhdGVWaWRlb0luc3RhbmNlIiwidmlkZW9JZCIsInBheW1lbnRVc2VybmFtZSIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwYXltZW50X3VzZXJuYW1lIiwiaGVhZGVycyIsInRoZW4iLCJyZXMiLCJqc29uIiwiZ2V0VmlkZW9JbnN0YW5jZSIsImNvZGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./services/videoService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("./pages/api/videos/[videoId]/instances/index.ts"));
module.exports = __webpack_exports__;

})();